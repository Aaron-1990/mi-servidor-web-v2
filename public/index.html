<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VSM Real-Time Monitor - BorgWarner</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #0f172a; color: #e2e8f0; min-height: 100vh; display: flex; flex-direction: column; align-items: center; }
        .header { width: 100%; background: #1e293b; padding: 20px 40px; border-bottom: 2px solid #334155; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 1.5rem; color: #f8fafc; }
        .header h1 span { color: #38bdf8; }
        .admin-link { background: #334155; color: #94a3b8; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-size: 0.85rem; transition: all 0.2s; }
        .admin-link:hover { background: #475569; color: #e2e8f0; }
        .content { padding: 40px; width: 100%; max-width: 1200px; }
        .subtitle { color: #94a3b8; margin-bottom: 30px; font-size: 1rem; }
        .lines-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        .line-card { background: #1e293b; border: 1px solid #334155; border-radius: 12px; padding: 24px; transition: all 0.2s; cursor: pointer; text-decoration: none; color: inherit; display: block; }
        .line-card:hover { border-color: #38bdf8; transform: translateY(-2px); box-shadow: 0 4px 20px rgba(56, 189, 248, 0.15); }
        .line-card .name { font-size: 1.25rem; font-weight: 600; color: #f8fafc; margin-bottom: 4px; }
        .line-card .code { font-size: 0.8rem; color: #64748b; margin-bottom: 16px; font-family: monospace; }
        .line-card .stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }
        .stat { text-align: center; }
        .stat .value { font-size: 1.3rem; font-weight: 700; color: #38bdf8; }
        .stat .label { font-size: 0.7rem; color: #64748b; text-transform: uppercase; margin-top: 2px; }
        .line-card .go { margin-top: 16px; text-align: right; color: #38bdf8; font-size: 0.85rem; }
        .loading { color: #64748b; text-align: center; padding: 60px; font-size: 1rem; }
        .error { color: #f87171; text-align: center; padding: 60px; }
    </style>
</head>
<body>
    <div class="header">
        <h1><span>VSM</span> Real-Time Monitor</h1>
        <a href="/admin" class="admin-link">Admin Panel</a>
    </div>
    <div class="content">
        <p class="subtitle">Select a production line to monitor</p>
        <div id="lines-container" class="lines-grid">
            <div class="loading">Loading production lines...</div>
        </div>
    </div>
    <script>
        var API_BASE = window.location.origin;
        function loadLines() {
            var container = document.getElementById("lines-container");
            fetch(API_BASE + "/api/lines")
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    if (!data.success || !data.lines.length) {
                        container.innerHTML = "<div class=error>No production lines found</div>";
                        return;
                    }
                    container.innerHTML = data.lines.map(function(line) {
                        return "<a href=/monitor/" + line.line_code + " class=line-card>" +
                            "<div class=name>" + line.line_name + "</div>" +
                            "<div class=code>" + line.line_code + "</div>" +
                            "<div class=stats>" +
                                "<div class=stat><div class=value>" + line.equipment_count + "</div><div class=label>Equipment</div></div>" +
                                "<div class=stat><div class=value>" + (parseFloat(line.takt_time) || "-") + "s</div><div class=label>Takt Time</div></div>" +
                                "<div class=stat><div class=value>" + (line.target_output || "-") + "</div><div class=label>Target/Shift</div></div>" +
                            "</div>" +
                            "<div class=go>View Monitor &#8594;</div>" +
                        "</a>";
                    }).join("");
                })
                .catch(function(err) {
                    container.innerHTML = "<div class=error>Error: " + err.message + "</div>";
                });
        }
        loadLines();
    </script>
</body>
</html>